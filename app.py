# Jobcan勤怠自動化ツール

Jobcanの勤怠打刻を自動化するPythonスクリプトです。Excelファイルから勤怠データを読み取り、Jobcanに自動入力します。

## 🚀 新機能・改善点

### 詳細ログ機能
- 📊 リアルタイム進捗表示
- 🔍 詳細なデバッグ情報
- 📋 ステップ別の処理状況
- ✅ 成功/失敗の明確な表示

### 改善された勤怠入力
- 📅 より正確な日付選択機能
- ⏰ 時刻入力の精度向上
- 🔧 打刻修正ボタンの検出改善
- 💾 保存処理の強化

### エラーハンドリング
- ❌ 詳細なエラー情報
- 🔄 自動リトライ機能
- 📊 エラー統計の表示

## 機能

- Excelファイルからの勤怠データ読み込み
- Jobcanへの自動ログイン
- 勤怠データの自動入力
- ヘッドレスモード対応
- 詳細なログと進捗表示
- エラーハンドリングとリトライ機能

## 必要な環境

- Python 3.8以上
- Playwright
- pandas
- Flask（Webアプリケーション用）

## インストール

```bash
pip install -r requirements.txt
playwright install chromium
```

## 使用方法

### 1. Webアプリケーション版（推奨）

```bash
python app.py
```

ブラウザで `http://localhost:5000` にアクセスしてください。

### 2. コマンドライン版

```bash
python jobcan_automation.py
```

## Excelファイルの形式

Excelファイルは以下の形式で作成してください：

| 日付 | 始業時刻 | 終業時刻 |
|------|----------|----------|
| 2024/01/01 | 09:00 | 18:00 |
| 2024/01/02 | 09:00 | 18:00 |

## 処理の流れ

1. **ブラウザ起動** 🌐
2. **Jobcanログイン** 🔐
3. **勤怠ページ移動** 📊
4. **日付選択** 📅
5. **打刻修正ボタンクリック** 🔧
6. **始業時刻入力** ⏰
7. **終業時刻入力** ⏰
8. **保存処理** 💾
9. **次のデータへ** 🔄

## ログの詳細

処理中は以下の詳細情報が表示されます：

- 📊 現在のステップ
- 🔍 検索中のセレクター
- ✅ 成功した操作
- ❌ 失敗した操作
- 📋 エラーメッセージ
- ⏳ 処理時間

## 注意事項

- 本ツールは個人利用を目的としています
- 利用規約に従ってご利用ください
- ログイン情報は安全に管理してください
- 処理中はブラウザを操作しないでください

## トラブルシューティング

### ログインが失敗する場合
- メールアドレスとパスワードを確認
- CAPTCHAが表示されている場合は手動でログイン
- ネットワーク接続を確認

### 勤怠入力が失敗する場合
- Excelファイルの形式を確認
- 日付形式が正しいか確認
- 時刻形式が正しいか確認（HH:MM）

### 詳細なログを確認したい場合
- Webアプリケーションのログ画面で詳細を確認
- 各ステップの成功/失敗状況を確認

## ファイル構成

```
jobcan_automation-main/
├── app.py                    # メインWebアプリケーション
├── jobcan_automation.py      # 自動化エンジン
├── utils.py                  # ユーティリティ関数
├── requirements.txt          # Python依存関係
├── templates/
│   └── index.html           # Webインターフェース
└── uploads/                 # アップロードファイル保存先
```

## 開発

### ローカル実行

```bash
# 依存関係をインストール
pip install -r requirements.txt

# Playwrightブラウザをインストール
playwright install chromium

# アプリケーションを起動
python app.py
```

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。 
