# Jobcan勤怠自動申請Webアプリケーション

Jobcanの勤怠データをExcelファイルから自動入力するWebアプリケーションです。

## 機能

- **自動ログイン**: メールアドレスとパスワードでJobcanに自動ログイン
- **Excelデータ読み込み**: A列（日付）、B列（始業時刻）、C列（終業時刻）のExcelファイルを処理
- **自動打刻**: 各日付の勤怠データを自動的に入力・打刻
- **リアルタイム進捗**: Webインターフェースで処理状況をリアルタイム表示
- **セキュア**: ログイン情報は処理中のみメモリに保存、処理完了後に自動削除

## 要件

- Python 3.11+
- Playwright
- Flask
- Railwayデプロイ対応

## 使用方法

1. **ログイン情報を入力** - メールアドレスとパスワード
2. **Excelファイルをアップロード** - A列：日付、B列：始業時刻、C列：終業時刻
3. **自動処理開始** - ボタンをクリックして処理を開始
4. **進捗確認** - リアルタイムで処理状況を確認

## ファイル形式

Excelファイル（.xlsx, .xls）の形式：
- **A列**: 日付（YYYY/MM/DD形式）
- **B列**: 始業時刻（HH:MM形式）
- **C列**: 終業時刻（HH:MM形式）
- **1行目**: ヘッダー行（任意）

例：
```
日付        始業時刻    終業時刻
2024/01/15  09:00      18:00
2024/01/16  08:30      17:30
```

## セキュリティ

- **一時的な保存**: ログイン情報は処理中のみメモリに保存
- **自動削除**: 処理完了後にログイン情報を自動削除
- **ログイン情報はサーバーに保存されません**

## トラブルシューティング

### ログインに失敗する場合
- メールアドレスとパスワードが正しいか確認してください
- JobcanのログインURL（https://id.jobcan.jp/users/sign_in?app_key=atd）にアクセスできるか確認してください

### Excelファイルが読み込めない場合
- ファイル形式が.xlsxまたは.xlsであることを確認
- A列、B列、C列に正しいデータが入力されていることを確認

### 処理が途中で止まる場合
- ブラウザの自動化が正常に動作しているか確認
- ネットワーク接続を確認

## ファイル構成

```
jobcan_web_app/
├── app.py              # メインアプリケーション
├── requirements.txt    # Python依存関係
├── Dockerfile         # Docker設定
├── railway.json       # Railway設定
├── Procfile          # Railwayプロセス設定
├── build.sh          # ビルドスクリプト
├── deploy.sh         # デプロイスクリプト
├── create_sample.py  # サンプルデータ作成
├── templates/
│   └── index.html    # Webインターフェース
└── uploads/          # アップロードファイル保存先
```

## デプロイ

### Railwayでのデプロイ

1. GitHubリポジトリを作成
2. コードをプッシュ
3. Railwayでリポジトリを接続
4. 自動デプロイが開始

### 環境変数

- `SECRET_KEY`: Flaskアプリケーションの秘密鍵
- `PORT`: アプリケーションのポート番号（Railwayが自動設定）

## 開発

### ローカル実行

```bash
# 依存関係をインストール
pip install -r requirements.txt

# Playwrightブラウザをインストール
playwright install chromium

# アプリケーションを起動
python app.py
```

### サンプルデータ作成

```bash
python create_sample.py
```

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。 
