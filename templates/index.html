<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jobcan AutoFill</title>
    
    {# Google Search Console æ‰€æœ‰æ¨©ç¢ºèª #}
    <meta name="google-site-verification" content="bQuTb9pABqynDmXqfDdakvmFSqz8y8MyYnOExuucmnA" />
    
    {# Google AdSense - æœ¬ç•ªç’°å¢ƒã®ã¿ã€é™¤å¤–ãƒšãƒ¼ã‚¸ä»¥å¤–ã§èª­ã¿è¾¼ã¿ #}
    {% if ADSENSE_ENABLED and not (request.path.startswith('/login') or request.path.startswith('/app/') or request.path in ['/privacy', '/contact', '/thanks']) %}
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4232725615106709" crossorigin="anonymous"></script>
    {% endif %}
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
    <style>
        /* CSSå¤‰æ•°å®šç¾© - æ¿ƒã„é’è‰²ç³» */
        :root {
            --primary-blue: #003366;
            --primary-blue-light: #004c99;
            --primary-blue-dark: #002B5C;
            --primary-blue-transparent: rgba(0, 51, 102, 0.9);
            --primary-blue-light-transparent: rgba(0, 76, 153, 0.9);
            --primary-blue-dark-transparent: rgba(0, 43, 92, 0.9);
        }
        
        /* ã‚·ãƒƒã‚¯ã§æ´—ç·´ã•ã‚ŒãŸUIãƒ‡ã‚¶ã‚¤ãƒ³ */
        * {
            box-sizing: border-box;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
        }
        
        body {
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #121212 0%, #1A1A1A 50%, #0F0F0F 100%);
            min-height: 100vh;
            color: #FFFFFF;
            letter-spacing: 0.05em;
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: linear-gradient(145deg, #1E1E1E 0%, #2A2A2A 100%);
            border-radius: 20px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header {
            background-image: url("{{ url_for('static', filename='JobcanAutofill.png') }}");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: #FFFFFF;
            padding: 80px 40px;
            text-align: center;
            position: relative;
            margin-bottom: 35px;
            min-height: 240px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--primary-blue-transparent), transparent);
            border-radius: 2px;
            box-shadow: 0 0 10px var(--primary-blue-transparent);
        }
        
        .header h1 {
            margin: 0;
            font-size: 3.2em;
            font-weight: 600;
            letter-spacing: 0.08em;
            font-family: 'Inter', 'Segoe UI', 'Helvetica Neue', 'Arial', sans-serif;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 255, 255, 0.1);
            position: relative;
            color: #FFFFFF;
        }
        
        .header h1::before {
            content: 'ğŸ•’';
            position: absolute;
            left: -50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.6em;
            opacity: 0.8;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        

        
        .header p {
            margin: 15px 0 0 0;
            opacity: 0.9;
            font-size: 1.2em;
            font-weight: 300;
            letter-spacing: 0.05em;
        }
        
        .header-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }
        
        .header-subtitle {
            margin: 10px 0 20px 0;
            font-size: 1.4em;
            font-weight: 400;
            opacity: 0.9;
            color: #FFFFFF;
        }
        
        .header-info {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .copyright {
            margin: 5px 0;
            font-size: 0.9em;
            opacity: 0.7;
            color: #FFFFFF;
        }
        
        .developer {
            margin: 5px 0;
            font-size: 0.9em;
            opacity: 0.8;
            color: #FFFFFF;
            font-weight: 500;
        }
        
        /* ãƒ•ãƒƒã‚¿ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .footer {
            background: linear-gradient(145deg, #1A1A1A 0%, #0F0F0F 100%);
            padding: 40px;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 0;
        }
        
        .footer-content {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .footer h2 {
            margin: 0 0 15px 0;
            font-size: 2.2em;
            font-weight: 600;
            letter-spacing: 0.08em;
            color: #FFFFFF;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .footer-subtitle {
            margin: 10px 0 25px 0;
            font-size: 1.2em;
            font-weight: 400;
            opacity: 0.9;
            color: #FFFFFF;
        }
        
        .footer-info {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .footer .copyright {
            margin: 8px 0;
            font-size: 0.95em;
            opacity: 0.7;
            color: #FFFFFF;
        }
        
        .footer .developer {
            margin: 8px 0;
            font-size: 0.95em;
            opacity: 0.8;
            color: #FFFFFF;
            font-weight: 500;
        }
        
        .footer-links a:hover {
            color: #FFFFFF !important;
            text-decoration: underline !important;
        }
        
        .content {
            padding: 50px 40px;
            background: linear-gradient(145deg, #1E1E1E 0%, #2A2A2A 100%);
        }
        
        .form-group {
            margin-bottom: 30px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 400;
            color: #FFFFFF;
            font-size: 1.1em;
            letter-spacing: 0.05em;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .form-group input[type="email"],
        .form-group input[type="password"],
        .form-group input[type="text"],
        .form-group input[type="file"] {
            width: 100%;
            padding: 18px 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
            background: rgba(30, 30, 30, 0.8);
            color: #FFFFFF;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-sizing: border-box;
            letter-spacing: 0.02em;
        }
        
        .form-group input[type="email"]:focus,
        .form-group input[type="password"]:focus,
        .form-group input[type="text"]:focus,
        .form-group input[type="file"]:focus {
            outline: none;
            border-color: var(--primary-blue-transparent);
            box-shadow: 
                0 0 0 3px var(--primary-blue-transparent),
                0 4px 12px rgba(0, 0, 0, 0.2);
            background: rgba(40, 40, 40, 0.9);
        }
        
        .form-group input[type="email"]::placeholder,
        .form-group input[type="password"]::placeholder,
        .form-group input[type="text"]::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .submit-btn {
            background: transparent;
            color: #FFFFFF;
            padding: 18px 40px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 400;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            margin-top: 30px;
            letter-spacing: 0.05em;
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .submit-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary-blue-transparent);
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                0 0 0 1px var(--primary-blue-transparent);
        }
        
        .submit-btn:hover::before {
            left: 100%;
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .download-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: transparent;
            color: #FFFFFF;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 400;
            letter-spacing: 0.05em;
            position: relative;
            overflow: hidden;
        }
        
        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .download-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.1);
        }
        
        .download-btn:hover::before {
            left: 100%;
        }
        
        .download-btn:active:not(:disabled) {
            transform: translateY(0);
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.1);
        }
        
        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .info-section {
            background: rgba(40, 40, 40, 0.6);
            padding: 35px;
            border-radius: 16px;
            margin-top: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .info-section h3 {
            margin: 0 0 20px 0;
            color: #FFFFFF;
            font-size: 1.4em;
            font-weight: 400;
            letter-spacing: 0.05em;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .info-section ul {
            margin: 0;
            padding-left: 25px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.8;
            font-size: 1rem;
        }
        
        .info-section li {
            margin-bottom: 8px;
            letter-spacing: 0.02em;
        }
        
        .security-notice {
            background: rgba(0, 51, 102, 0.1);
            border: 1px solid rgba(0, 51, 102, 0.3);
            border-radius: 12px;
            padding: 25px;
            margin-top: 35px;
        }
        
        .security-notice h4 {
            margin: 0 0 12px 0;
            color: var(--primary-blue-light);
            font-weight: 400;
            letter-spacing: 0.05em;
        }
        
        .security-notice p {
            margin: 0;
            color: rgba(0, 76, 153, 0.9);
            line-height: 1.6;
            font-size: 0.95em;
        }
        
        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
        .progress-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .progress-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #1E1E1E 0%, #2A2A2A 100%);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .progress-header h3 {
            margin: 0;
            color: #FFFFFF;
            font-size: 1.6em;
            font-weight: 400;
            letter-spacing: 0.05em;
        }
        
        .progress-status {
            background: rgba(40, 40, 40, 0.6);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid var(--primary-blue-transparent);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-status h4 {
            margin: 0 0 12px 0;
            color: #FFFFFF;
            font-size: 1.2em;
            font-weight: 400;
            letter-spacing: 0.05em;
        }
        
        .progress-status p {
            margin: 0;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .progress-log {
            background: rgba(20, 20, 20, 0.8);
            color: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 20px;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
            font-size: 0.9em;
            max-height: 250px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            letter-spacing: 0.02em;
        }
        
        .progress-actions {
            text-align: center;
        }
        
        .progress-btn {
            background: transparent;
            color: #FFFFFF;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
            margin: 0 10px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 0.05em;
        }
        
        .progress-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary-blue-transparent);
            transform: translateY(-1px);
        }
        
        .progress-btn.secondary {
            background: rgba(100, 100, 100, 0.3);
            border-color: rgba(100, 100, 100, 0.5);
        }
        
        .progress-btn.secondary:hover {
            background: rgba(120, 120, 120, 0.4);
            border-color: rgba(150, 150, 150, 0.6);
        }
        
        .error-details {
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .error-details h5 {
            margin: 0 0 12px 0;
            color: #DC3545;
            font-weight: 400;
            letter-spacing: 0.05em;
        }
        
        .error-details ul {
            margin: 0;
            padding-left: 25px;
            color: rgba(220, 53, 69, 0.9);
            line-height: 1.6;
        }
        
        .login-result {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .login-result h5 {
            margin: 0 0 12px 0;
            color: #28A745;
            font-weight: 400;
            letter-spacing: 0.05em;
        }
        
        .login-result.success {
            background: rgba(40, 167, 69, 0.1);
            border-color: rgba(40, 167, 69, 0.3);
        }
        
        .login-result.error {
            background: rgba(220, 53, 69, 0.1);
            border-color: rgba(220, 53, 69, 0.3);
        }
        
        .login-result.warning {
            background: rgba(0, 51, 102, 0.1);
            border-color: rgba(0, 51, 102, 0.3);
        }
        
        .message-content {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            white-space: pre-line;
            color: rgba(255, 255, 255, 0.9);
            border-left: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .message-content.error {
            background: rgba(220, 53, 69, 0.1);
            border-left-color: rgba(220, 53, 69, 0.5);
        }
        
        .message-content.warning {
            background: rgba(0, 51, 102, 0.1);
            border-left-color: rgba(0, 51, 102, 0.5);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid var(--primary-blue-transparent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .status-success {
            border-left-color: rgba(40, 167, 69, 0.5);
        }
        
        .status-error {
            border-left-color: rgba(220, 53, 69, 0.5);
        }
        
        .status-warning {
            border-left-color: rgba(0, 51, 102, 0.5);
        }
        
        /* æ³¨æ„æ›¸ãã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .warning-notice {
            background: rgba(44, 44, 44, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .warning-notice h4 {
            margin: 0 0 15px 0;
            color: #ffffff;
            font-size: 1.2em;
            font-weight: 400;
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: 0.05em;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
        }
        
        .warning-notice p {
            margin: 0 0 12px 0;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.7;
            font-size: 0.95em;
            letter-spacing: 0.02em;
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
        }
        
        .warning-notice p:last-child {
            margin-bottom: 0;
        }
        
        .warning-notice strong {
            color: #ffffff;
            font-weight: 500;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            body {
                padding: 15px;
                font-size: 0.95rem;
            }
            
            .container {
                border-radius: 15px;
            }
            
            .header {
                padding: 60px 25px;
                min-height: 200px;
            }
            
            .content {
                padding: 30px 25px;
            }
            
            .footer {
                padding: 30px 25px;
            }
            
            .footer h2 {
                font-size: 1.8em;
            }
            
            .footer-subtitle {
                font-size: 1.1em;
            }
            
            .progress-content {
                padding: 30px 25px;
                width: 95%;
            }
        }
        
        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <!-- èƒŒæ™¯ç”»åƒã¨ã—ã¦ãƒ­ã‚´ã‚’è¡¨ç¤º -->
        </div>
        
        <div class="content">
            <form id="uploadForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                    <input type="email" id="email" name="email" required placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›">
                </div>
                
                <div class="form-group">
                    <label for="company_id">ä¼šç¤¾IDï¼ˆä»»æ„ï¼‰</label>
                    <input type="text" id="company_id" name="company_id" placeholder="ä¼šç¤¾IDï¼ˆä»»æ„ï¼‰ã‚’å…¥åŠ›">
                </div>
                
                <div class="form-group">
                    <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                    <input type="password" id="password" name="password" required placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
                </div>
                
                <div class="form-group">
                    <label for="file">Excelãƒ•ã‚¡ã‚¤ãƒ«</label>
                    <input type="file" id="file" name="file" accept=".xlsx,.xls" required>
                </div>
                
                <button type="submit" class="submit-btn" id="submitBtn">
                    å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å…¥åŠ›
                </button>
            </form>
            
            <div class="info-section">
                <h3>ä½¿ç”¨æ–¹æ³•</h3>
                <ul>
                    <li>Jobcanã®ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰ã‚’å…¥åŠ›</li>
                    <li>å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚ŒãŸExcelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</li>
                    <li>Excelãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ï¼šAåˆ—=æ—¥ä»˜ã€Båˆ—=é–‹å§‹æ™‚åˆ»ã€Cåˆ—=çµ‚äº†æ™‚åˆ»ï¼ˆ1è¡Œç›®ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰</li>
                    <li>è‡ªå‹•ã§Jobcanã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã€å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¾ã™</li>
                </ul>
                <p style="margin-top: 20px; padding: 15px; background: rgba(74, 158, 255, 0.1); border-left: 4px solid #4A9EFF; border-radius: 8px;">
                    <strong>ğŸ“š è©³ã—ã„ä½¿ã„æ–¹ã¯</strong><a href="/guide/getting-started" style="color: #4A9EFF; margin-left: 8px;">ã¯ã˜ã‚ã¦ã®ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</a>ã‚’ã”è¦§ãã ã•ã„ã€‚
                </p>
                <div style="margin-top: 20px; text-align: center;">
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button type="button" class="submit-btn download-btn" onclick="downloadTemplate('current')" style="display: inline-block; text-decoration: none; text-align: center; min-width: 200px; margin: 0; cursor: pointer;">
                            ä»Šæœˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’<br>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                        <button type="button" class="submit-btn download-btn" onclick="downloadTemplate('previous')" style="display: inline-block; text-decoration: none; text-align: center; min-width: 200px; margin: 0; cursor: pointer;">
                            å…ˆæœˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’<br>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                    </div>
                </div>
                
                <!-- æ³¨æ„æ›¸ãã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="warning-notice">
                    <h4>âš ï¸ ã”åˆ©ç”¨ã«ã‚ãŸã£ã¦ã®ã”æ³¨æ„</h4>
                    <p>æœ¬ã‚¢ãƒ—ãƒªã¯ã€å€‹äººã®æ¥­å‹™åŠ¹ç‡åŒ–ã‚’ç›®çš„ã¨ã—ã¦é–‹ç™ºã•ã‚ŒãŸã‚‚ã®ã§ã‚ã‚Šã€ä¼šç¤¾ã®å…¬å¼ãƒ„ãƒ¼ãƒ«ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>Jobcanã¸ã®å‹¤æ€ ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã‚’è£œåŠ©ã™ã‚‹ã‚‚ã®ã§ã™ãŒã€æ­£ç¢ºãªå‹¤æ€ æƒ…å ±ã®ç™»éŒ²ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚</p>
                    <p>å®Ÿéš›ã®å‹¤å‹™å®Ÿæ…‹ã¨ç•°ãªã‚‹æ‰“åˆ»ã®å…¥åŠ›ã‚„ã€æ‰€å±ä¼æ¥­ã®å°±æ¥­è¦å‰‡ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã«åã™ã‚‹ä½¿ç”¨ã¯ã€æ³•ä»¤ã¾ãŸã¯ç¤¾å†…è¦å®šã«æŠµè§¦ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
                    <p><strong>è‡ªå‹•å…¥åŠ›æ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã®éš›ã¯ã€ã”è‡ªèº«ã®åˆ¤æ–­ã¨è²¬ä»»ã€ãã—ã¦å€«ç†è¦³ã‚’ã‚‚ã£ã¦æ…é‡ã«ã”ä½¿ç”¨ãã ã•ã„ã€‚</strong></p>
                </div>
            </div>
            
                            <div class="security-notice">
                    <h4>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¤ã„ã¦</h4>
                    <p>å…¥åŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã¯ä¸€æ™‚çš„ã«ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ã•ã‚Œã€å‡¦ç†å®Œäº†å¾Œã«è‡ªå‹•çš„ã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚<br>ã‚µãƒ¼ãƒãƒ¼ã«ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚</p>
                </div>
            
            <!-- æ–°è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼šå……å®Ÿã—ãŸæƒ…å ±ã‚’æä¾› -->
            <div style="margin-top: 50px; padding-top: 40px; border-top: 2px solid rgba(255, 255, 255, 0.1);">
                <h2 style="font-size: 1.8em; margin-bottom: 30px; color: #FFFFFF; text-align: center; letter-spacing: 0.05em;">
                    Jobcanå‹¤æ€ ç®¡ç†ã‚’åŠ¹ç‡åŒ–ã™ã‚‹ç·åˆã‚¬ã‚¤ãƒ‰
                </h2>
                
                <div style="background: rgba(44, 44, 44, 0.6); border-radius: 16px; padding: 30px; margin-bottom: 30px;">
                    <h3 style="color: #4A9EFF; font-size: 1.3em; margin-bottom: 20px;">ğŸ¯ ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦</h3>
                    <p style="line-height: 1.8; margin-bottom: 15px;">
                        Jobcan AutoFillã¯ã€Jobcanï¼ˆæ ªå¼ä¼šç¤¾ã‚¸ãƒ§ãƒ–ã‚«ãƒ³ï¼‰ãŒæä¾›ã™ã‚‹å‹¤æ€ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å‹¤æ€ ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ—ãƒ­ã‚»ã‚¹ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã€å€‹äººå‘ã‘ã®åŠ¹ç‡åŒ–ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æ‰‹ä½œæ¥­ã§ã®ç¹°ã‚Šè¿”ã—å…¥åŠ›ä½œæ¥­ã‚’å‰Šæ¸›ã—ã€è²´é‡ãªæ™‚é–“ã‚’ã‚ˆã‚Šé‡è¦ãªæ¥­å‹™ã«å……ã¦ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚
                    </p>
                    <p style="line-height: 1.8; margin-bottom: 15px;">
                        æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã€Playwrightã¨ã„ã†æœ€æ–°ã®ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–æŠ€è¡“ã‚’æ´»ç”¨ã—ã€äººé–“ã®æ“ä½œã‚’å†ç¾ã™ã‚‹ã“ã¨ã§ã€å®‰å…¨ã‹ã¤æ­£ç¢ºã«ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚è¤‡æ•°ã®å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬ã§å‡¦ç†ã§ãã‚‹ãŸã‚ã€æœˆæ¬¡ç· ã‚ã‚„æœˆæœ«ã®å‹¤æ€ ç¢ºå®šä½œæ¥­ãŒå¤§å¹…ã«çŸ­ç¸®ã•ã‚Œã¾ã™ã€‚
                    </p>
                    <p style="line-height: 1.8;">
                        ã¾ãŸã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€æ—¢å­˜ã®å‹¤æ€ ç®¡ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨è‡ªç„¶ã«çµ±åˆã§ãã€å­¦ç¿’ã‚³ã‚¹ãƒˆã‚’æœ€å°é™ã«æŠ‘ãˆãªãŒã‚‰é‹ç”¨ã‚’é–‹å§‹ã§ãã¾ã™ã€‚
                    </p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 30px;">
                    <div style="background: rgba(74, 158, 255, 0.1); border: 1px solid rgba(74, 158, 255, 0.3); border-radius: 12px; padding: 25px;">
                        <h4 style="color: #4A9EFF; font-size: 1.2em; margin-bottom: 15px;">âš¡ ä¸»ãªæ©Ÿèƒ½</h4>
                        <ul style="list-style: none; padding: 0; margin: 0;">
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">âœ“ ä¸€æ‹¬å‹¤æ€ ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">âœ“ Excelãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®è‡ªå‹•èª­ã¿è¾¼ã¿</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">âœ“ äººé–“ã‚‰ã—ã„æ“ä½œãƒ‘ã‚¿ãƒ¼ãƒ³ã®å†ç¾</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">âœ“ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®å‡¦ç†é€²æ—è¡¨ç¤º</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">âœ“ ã‚»ã‚­ãƒ¥ã‚¢ãªä¸€æ™‚çš„ãƒ‡ãƒ¼ã‚¿å‡¦ç†</li>
                        </ul>
                    </div>
                    
                    <div style="background: rgba(74, 158, 255, 0.1); border: 1px solid rgba(74, 158, 255, 0.3); border-radius: 12px; padding: 25px;">
                        <h4 style="color: #4A9EFF; font-size: 1.2em; margin-bottom: 15px;">ğŸ“ åˆ©ç”¨ã‚·ãƒ¼ãƒ³</h4>
                        <ul style="list-style: none; padding: 0; margin: 0;">
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">â€¢ æœˆæ¬¡å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬ç™»éŒ²</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">â€¢ é…åˆ»ãƒ»æ—©é€€ãƒ‡ãƒ¼ã‚¿ã®ä¿®æ­£ä½œæ¥­</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">â€¢ éå»æœˆã®å‹¤æ€ ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">â€¢ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã®å‹¤æ€ æ™‚é–“å…¥åŠ›</li>
                            <li style="margin-bottom: 10px; padding-left: 20px; position: relative;">â€¢ å®šæ™‚çš„ãªå‹¤æ€ ãƒ‡ãƒ¼ã‚¿ç®¡ç†ä½œæ¥­</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: rgba(255, 152, 0, 0.1); border-left: 4px solid #FF9800; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                    <h4 style="color: #FF9800; font-size: 1.2em; margin-bottom: 15px;">ğŸ“‹ ä½¿ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿å½¢å¼</h4>
                    <p style="line-height: 1.8; margin-bottom: 15px;">
                        æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã€ä»¥ä¸‹ã®å½¢å¼ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼š
                    </p>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: rgba(255, 255, 255, 0.05);">
                                <th style="padding: 12px; text-align: left; border: 1px solid rgba(255, 255, 255, 0.2);">åˆ—</th>
                                <th style="padding: 12px; text-align: left; border: 1px solid rgba(255, 255, 255, 0.2);">é …ç›®</th>
                                <th style="padding: 12px; text-align: left; border: 1px solid rgba(255, 255, 255, 0.2);">ä¾‹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">Aåˆ—</td>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">æ—¥ä»˜</td>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">2025-10-01 ã¾ãŸã¯ 2025/10/01</td>
                            </tr>
                            <tr style="background: rgba(255, 255, 255, 0.02);">
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">Båˆ—</td>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">é–‹å§‹æ™‚åˆ»</td>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">09:00 ã¾ãŸã¯ 0900</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">Cåˆ—</td>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">çµ‚äº†æ™‚åˆ»</td>
                                <td style="padding: 12px; border: 1px solid rgba(255, 255, 255, 0.2);">18:00 ã¾ãŸã¯ 1800</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div style="background: rgba(76, 175, 80, 0.1); border-left: 4px solid #4CAF50; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                    <h4 style="color: #4CAF50; font-size: 1.2em; margin-bottom: 15px;">âœ… æœ€é©ãªä½¿ç”¨æ–¹æ³•</h4>
                    <ol style="line-height: 1.8; padding-left: 25px;">
                        <li style="margin-bottom: 10px;">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¾ã™ã€‚</li>
                        <li style="margin-bottom: 10px;">ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å…¥åŠ›ã—ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</li>
                        <li style="margin-bottom: 10px;">ã€Œå‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å…¥åŠ›ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚</li>
                        <li style="margin-bottom: 10px;">å‡¦ç†ã®é€²æ—ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã•ã‚Œã‚‹ãŸã‚ã€çŠ¶æ³ã‚’å¸¸ã«æŠŠæ¡ã§ãã¾ã™ã€‚</li>
                        <li style="margin-bottom: 10px;">å‡¦ç†å®Œäº†å¾Œã€Jobcanã§ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚</li>
                    </ol>
                </div>
                
                <div style="text-align: center; margin-top: 40px; padding-top: 30px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                    <p style="font-size: 1.1em; margin-bottom: 20px; color: rgba(255, 255, 255, 0.9);">
                        ã‚ˆã‚Šè©³ã—ã„æƒ…å ±ã‚„ä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ã‚¬ã‚¤ãƒ‰ã‚’ã”å‚ç…§ãã ã•ã„
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <a href="/guide/getting-started" style="display: inline-block; padding: 12px 24px; background: rgba(74, 158, 255, 0.2); border: 1px solid rgba(74, 158, 255, 0.5); border-radius: 8px; color: #4A9EFF; text-decoration: none; transition: all 0.3s;">ã¯ã˜ã‚ã¦ã®ä½¿ã„æ–¹</a>
                        <a href="/faq" style="display: inline-block; padding: 12px 24px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 8px; color: #FFFFFF; text-decoration: none; transition: all 0.3s;">ã‚ˆãã‚ã‚‹è³ªå•</a>
                        <a href="/guide/troubleshooting" style="display: inline-block; padding: 12px 24px; background: rgba(255, 152, 0, 0.2); border: 1px solid rgba(255, 152, 0, 0.5); border-radius: 8px; color: #FF9800; text-decoration: none; transition: all 0.3s;">ãƒˆãƒ©ãƒ–ãƒ«è§£æ±º</a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
        <div class="footer">
            <div class="footer-content">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 30px; text-align: left;">
                    <div>
                        <h4 style="color: #FFFFFF; font-size: 1.1em; margin-bottom: 15px;">ã‚¬ã‚¤ãƒ‰</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <a href="/guide/getting-started" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ã¯ã˜ã‚ã¦ã®ä½¿ã„æ–¹</a>
                            <a href="/guide/excel-format" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆæ–¹æ³•</a>
                            <a href="/guide/troubleshooting" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a>
                        </div>
                    </div>
                    <div>
                        <h4 style="color: #FFFFFF; font-size: 1.1em; margin-bottom: 15px;">ãƒªã‚½ãƒ¼ã‚¹</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <a href="/faq" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰</a>
                            <a href="/glossary" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ç”¨èªé›†</a>
                            <a href="/about" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a>
                        </div>
                    </div>
                    <div>
                        <h4 style="color: #FFFFFF; font-size: 1.1em; margin-bottom: 15px;">æ³•çš„æƒ…å ±</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <a href="/privacy" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
                            <a href="/terms" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">åˆ©ç”¨è¦ç´„</a>
                            <a href="/contact" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9em;">ãŠå•ã„åˆã‚ã›</a>
                        </div>
                    </div>
                </div>
                <div class="footer-info" style="border-top: 1px solid rgba(255, 255, 255, 0.2); padding-top: 20px;">
                    <p class="copyright">Â© 2025 Jobcan Autofill. All rights reserved.</p>
                    <p class="developer">Developed by RT</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
    <div class="progress-popup" id="progressPopup">
        <div class="progress-content">
            <div class="progress-header">
                <h3>å‡¦ç†çŠ¶æ³</h3>
            </div>
            
            <div class="progress-status" id="progressStatus">
                <h4><span class="loading-spinner"></span>å‡¦ç†ä¸­...</h4>
                <p id="progressMessage">åˆæœŸåŒ–ä¸­...</p>
            </div>
            
            <div class="login-result" id="loginResult" style="display: none;">
                <h5>ãƒ­ã‚°ã‚¤ãƒ³çµæœ</h5>
                <div id="loginResultContent"></div>
            </div>
            
            <div class="progress-log" id="progressLog">
                <!-- ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
            
            <div class="error-details" id="errorDetails" style="display: none;">
                <h5>ã‚¨ãƒ©ãƒ¼è©³ç´°</h5>
                <div id="errorContent"></div>
            </div>
            
            <div class="progress-actions">
                <button class="progress-btn" id="closeBtn" onclick="closeProgressPopup()">é–‰ã˜ã‚‹</button>
                <button class="progress-btn secondary" id="retryBtn" onclick="retryProcess()" style="display: none;">å†è©¦è¡Œ</button>
            </div>
        </div>
    </div>
    
    <script>
        let currentJobId = null;
        let lastLoginStatus = null; // æœ€å¾Œã«è¡¨ç¤ºã—ãŸãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’è¨˜éŒ²
        
        document.getElementById('uploadForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const company_id = document.getElementById('company_id').value;
            const file = document.getElementById('file').files[0];
            
            if (!email || !password || !file) {
                alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¿…é ˆã§ã™ã€‚');
                return;
            }
            
            const formData = new FormData();
            formData.append('email', email);
            formData.append('password', password);
            if (company_id) {
                formData.append('company_id', company_id);
            }
            formData.append('file', file);
            
            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤º
            showProgressPopup();
            
            try {
                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.job_id) {
                    currentJobId = result.job_id;
                    updateProgressStatus('processing', 'å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ', 'Jobcanã¸ã®ãƒ­ã‚°ã‚¤ãƒ³ã¨ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚’é–‹å§‹ã—ã¦ã„ã¾ã™...');
                    startProgressPolling();
                } else {
                    updateProgressStatus('error', 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                    showErrorDetails(result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                }
                
            } catch (error) {
                updateProgressStatus('error', 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼', 'ã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                console.error('Error:', error);
            }
        });
        
        function showProgressPopup() {
            document.getElementById('progressPopup').style.display = 'block';
            document.getElementById('progressStatus').className = 'progress-status';
            document.getElementById('progressMessage').textContent = 'åˆæœŸåŒ–ä¸­...';
            document.getElementById('progressLog').textContent = '';
            document.getElementById('loginResult').style.display = 'none';
            document.getElementById('errorDetails').style.display = 'none';
            document.getElementById('retryBtn').style.display = 'none';
            lastLoginStatus = null; // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        }
        
        function closeProgressPopup() {
            document.getElementById('progressPopup').style.display = 'none';
        }
        
        function updateProgressStatus(type, title, message) {
            const statusDiv = document.getElementById('progressStatus');
            const titleElement = statusDiv.querySelector('h4');
            const messageElement = document.getElementById('progressMessage');
            
            // ã‚¯ãƒ©ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
            statusDiv.className = 'progress-status';
            
            // ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
            if (type === 'success') {
                statusDiv.classList.add('status-success');
                titleElement.innerHTML = 'âœ… ' + title;
            } else if (type === 'error') {
                statusDiv.classList.add('status-error');
                titleElement.innerHTML = 'âŒ ' + title;
            } else if (type === 'warning') {
                statusDiv.classList.add('status-warning');
                titleElement.innerHTML = 'âš ï¸ ' + title;
            } else {
                titleElement.innerHTML = '<span class="loading-spinner"></span>' + title;
            }
            
            messageElement.textContent = message;
        }
        
        function addProgressLog(message) {
            const logDiv = document.getElementById('progressLog');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function showLoginResult(loginStatus, loginMessage) {
            const loginResultDiv = document.getElementById('loginResult');
            const loginResultContent = document.getElementById('loginResultContent');
            
            // processingçŠ¶æ…‹ã®å ´åˆã¯è¡¨ç¤ºã—ãªã„
            if (loginStatus === 'processing') {
                loginResultDiv.style.display = 'none';
                return;
            }
            
            // ã‚¯ãƒ©ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
            loginResultDiv.className = 'login-result';
            
            let statusIcon = '';
            let statusClass = '';
            
            if (loginStatus === 'success') {
                statusIcon = 'âœ…';
                statusClass = 'success';
            } else if (loginStatus === 'captcha_detected') {
                statusIcon = 'âš ï¸';
                statusClass = 'warning';
            } else {
                statusIcon = 'âŒ';
                statusClass = 'error';
            }
            
            loginResultDiv.classList.add(statusClass);
            
            // æ”¹è¡Œã‚’é©åˆ‡ã«å‡¦ç†
            const formattedMessage = loginMessage.replace(/\n/g, '<br>');
            
            loginResultContent.innerHTML = `
                <p><strong>${statusIcon} ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹:</strong></p>
                <div class="message-content ${statusClass}">${formattedMessage}</div>
                <p><strong>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰:</strong> ${loginStatus}</p>
            `;
            
            loginResultDiv.style.display = 'block';
        }
        
        function showErrorDetails(errorMessage) {
            const errorDiv = document.getElementById('errorDetails');
            const errorContent = document.getElementById('errorContent');
            
            errorContent.innerHTML = `
                <p><strong>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:</strong></p>
                <p>${errorMessage}</p>
                <p><strong>è€ƒãˆã‚‰ã‚Œã‚‹åŸå› :</strong></p>
                <ul>
                    <li>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“</li>
                    <li>Jobcanã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç„¡åŠ¹ã¾ãŸã¯ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™</li>
                    <li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™</li>
                    <li>Jobcanã‚µãƒ¼ãƒ“ã‚¹ãŒãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­ã§ã™</li>
                    <li>CAPTCHAãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŸã‚æ‰‹å‹•ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™</li>
                </ul>
                <p><strong>è§£æ±ºç­–:</strong></p>
                <ul>
                    <li>ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å†ç¢ºèªã—ã¦ãã ã•ã„</li>
                    <li>æ‰‹å‹•ã§Jobcanã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
                    <li>åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¤ãƒ³ã‚’è©¦è¡Œã—ã¦ãã ã•ã„</li>
                    <li>ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„</li>
                </ul>
            `;
            
            errorDiv.style.display = 'block';
            document.getElementById('retryBtn').style.display = 'inline-block';
        }
        
        function startProgressPolling() {
            if (!currentJobId) return;
            
            // ãƒãƒ¼ãƒªãƒ³ã‚°å®Œäº†ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
            window.pollingCompleted = false;
            
            const pollInterval = setInterval(async () => {
                // ãƒãƒ¼ãƒªãƒ³ã‚°ãŒå®Œäº†ã—ã¦ã„ã‚‹å ´åˆã¯å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—
                if (window.pollingCompleted) {
                    clearInterval(pollInterval);
                    return;
                }
                try {
                    const response = await fetch(`/status/${currentJobId}`);
                    const result = await response.json();
                    
                    // ãƒ­ã‚°ã‚¤ãƒ³çµæœã‚’è¡¨ç¤ºï¼ˆprocessingçŠ¶æ…‹ä»¥å¤–ã®å ´åˆã®ã¿ã€ã‹ã¤çŠ¶æ…‹ãŒå¤‰ã‚ã£ãŸå ´åˆã®ã¿ï¼‰
                    if (result.login_status && result.login_message && result.login_status !== 'processing') {
                        // çŠ¶æ…‹ãŒå¤‰ã‚ã£ãŸå ´åˆã®ã¿è¡¨ç¤º
                        if (lastLoginStatus !== result.login_status) {
                            showLoginResult(result.login_status, result.login_message);
                            lastLoginStatus = result.login_status;
                        }
                    }
                    
                    if (result.status === 'completed') {
                        updateProgressStatus('success', 'å‡¦ç†å®Œäº†', result.user_message || 'å‹¤æ€ ãƒ‡ãƒ¼ã‚¿ã®å…¥åŠ›ãŒå®Œäº†ã—ã¾ã—ãŸã€‚');
                        addProgressLog('âœ… å‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ');
                        clearInterval(pollInterval);
                        document.getElementById('retryBtn').style.display = 'none';
                        // ãƒãƒ¼ãƒªãƒ³ã‚°å®Œäº†ãƒ•ãƒ©ã‚°ã‚’è¨­å®š
                        window.pollingCompleted = true;
                    } else if (result.status === 'error') {
                        updateProgressStatus('error', 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', result.user_message || 'å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                        addProgressLog('âŒ ã‚¨ãƒ©ãƒ¼: ' + (result.user_message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
                        clearInterval(pollInterval);
                        document.getElementById('retryBtn').style.display = 'inline-block';
                        // ãƒãƒ¼ãƒªãƒ³ã‚°å®Œäº†ãƒ•ãƒ©ã‚°ã‚’è¨­å®š
                        window.pollingCompleted = true;
                    } else {
                        // é€²è¡Œä¸­
                        updateProgressStatus('processing', result.step_name || 'å‡¦ç†ä¸­', result.user_message || 'å‡¦ç†ã‚’å®Ÿè¡Œä¸­ã§ã™...');
                        
                        // ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ä¸­ã®å ´åˆã¯ãƒ­ã‚°ã‚¤ãƒ³çµæœã‚’éè¡¨ç¤º
                        if (result.login_status === 'processing') {
                            document.getElementById('loginResult').style.display = 'none';
                        }
                        
                        if (result.logs && result.logs.length > 0) {
                            // æ–°ã—ã„ãƒ­ã‚°ã®ã¿ã‚’è¿½åŠ 
                            const currentLogs = document.getElementById('progressLog').textContent;
                            result.logs.forEach(log => {
                                if (!currentLogs.includes(log)) {
                                    addProgressLog(log);
                                }
                            });
                        }
                    }
                    
                } catch (error) {
                    console.error('Polling error:', error);
                    // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯è¡¨ç¤ºã—ãªã„
                    // å‡¦ç†å®Œäº†å¾Œã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ä¸€æ™‚çš„ãªå•é¡Œã§ç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚‹
                    
                    // é€£ç¶šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ãƒãƒ¼ãƒªãƒ³ã‚°ã‚’åœæ­¢
                    if (!window.pollingErrorCount) {
                        window.pollingErrorCount = 0;
                    }
                    window.pollingErrorCount++;
                    
                    if (window.pollingErrorCount > 5) {
                        console.warn('Too many polling errors, stopping polling');
                        clearInterval(pollInterval);
                        window.pollingCompleted = true;
                    }
                }
            }, 2000); // 2ç§’ã”ã¨ã«ãƒãƒ¼ãƒªãƒ³ã‚°
        }
        
        function retryProcess() {
            closeProgressPopup();
            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’å†é€ä¿¡
            document.getElementById('uploadForm').dispatchEvent(new Event('submit'));
        }
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        async function downloadTemplate(type) {
            try {
                const button = event.target;
                const originalText = button.innerHTML;
                
                // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã¦ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
                button.disabled = true;
                button.innerHTML = '<span class="loading-spinner"></span>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...';
                
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLã‚’æ±ºå®š
                const downloadUrl = type === 'current' ? '/download-template' : '/download-previous-template';
                
                // fetchã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
                const response = await fetch(downloadUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
                const contentDisposition = response.headers.get('content-disposition');
                let filename = 'template.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                
                // Blobã¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
                const blob = await response.blob();
                
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¦è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯
                const downloadLink = document.createElement('a');
                downloadLink.href = window.URL.createObjectURL(blob);
                downloadLink.download = filename;
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // ãƒœã‚¿ãƒ³ã‚’å…ƒã«æˆ»ã™
                button.disabled = false;
                button.innerHTML = originalText;
                
            } catch (error) {
                console.error('Download error:', error);
                
                // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒœã‚¿ãƒ³ã‚’å…ƒã«æˆ»ã™
                const button = event.target;
                button.disabled = false;
                button.innerHTML = originalText;
                
                // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                alert('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚');
            }
        }
    </script>
</body>
</html> 
