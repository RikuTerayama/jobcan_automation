{# 構造化データ（JSON-LD） #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Jobcan AutoFill",
  "url": "https://jobcan-automation.onrender.com",
  "logo": "https://jobcan-automation.onrender.com/static/JobcanAutofill.png",
  "description": "Jobcanへの勤怠データをExcelから一括入力する自動化ツール",
  "sameAs": [],
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "お問い合わせ",
    "url": "https://jobcan-automation.onrender.com/contact"
  }
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Jobcan AutoFill",
  "url": "https://jobcan-automation.onrender.com",
  "description": "Jobcanへの勤怠データをExcelから一括入力する自動化ツール",
  "publisher": {
    "@type": "Organization",
    "name": "Jobcan AutoFill"
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "https://jobcan-automation.onrender.com/?q={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
}
</script>

{% block extra_structured_data %}
{# BreadcrumbList JSON-LD（表示用短ラベルは breadcrumb_title を優先） #}
{% set current_path = request.path|default('/') if request is defined and request else '/' %}
{% set _crumb_name = breadcrumb_title|default(page_title)|default('') %}
{% if current_path != '/' %}
{% set breadcrumb_items = [] %}
{% set base_url = 'https://jobcan-automation.onrender.com' %}
{% set _ = breadcrumb_items.append({'name': 'ホーム', 'url': '/'}) %}
{% if current_path.startswith('/tools/') and current_path != '/tools' %}
    {% set _ = breadcrumb_items.append({'name': 'ツール一覧', 'url': '/tools'}) %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or current_path.split('/')[-1], 'url': current_path}) %}
{% elif current_path.startswith('/guide/') and current_path != '/guide/getting-started' %}
    {% set _ = breadcrumb_items.append({'name': 'ガイド', 'url': '/guide/getting-started'}) %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or current_path.split('/')[-1], 'url': current_path}) %}
{% elif current_path.startswith('/blog/') and current_path != '/blog' %}
    {% set _ = breadcrumb_items.append({'name': 'ブログ', 'url': '/blog'}) %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or current_path.split('/')[-1], 'url': current_path}) %}
{% elif current_path.startswith('/case-study/') %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or '導入事例', 'url': current_path}) %}
{% elif current_path == '/tools' %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or 'ツール一覧', 'url': '/tools'}) %}
{% elif current_path == '/blog' %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or 'ブログ', 'url': '/blog'}) %}
{% elif current_path == '/guide/getting-started' or current_path.startswith('/guide/') %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or 'ガイド', 'url': current_path}) %}
{% elif current_path != '/' %}
    {% set _ = breadcrumb_items.append({'name': _crumb_name or current_path, 'url': current_path}) %}
{% endif %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {% for item in breadcrumb_items %}
        {
            "@type": "ListItem",
            "position": {{ loop.index }},
            "name": "{{ item.name|e }}",
            "item": "{{ base_url }}{{ item.url }}"
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    ]
}
</script>
{% endif %}
{% endblock %}

