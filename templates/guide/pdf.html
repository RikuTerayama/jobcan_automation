<!DOCTYPE html>
<html lang="ja">
<head>
    {% set page_title = 'PDFユーティリティガイド | Automation Hub' %}
    {% include 'includes/head_meta.html' %}
    {% block description_meta %}
        <meta name="description" content="PDFユーティリティの使い方ガイド。PDFの結合・分割・ページ抽出、PDF→画像変換、圧縮、画像→PDF変換の方法を詳しく解説。">
    {% endblock %}
    <style>
        body {
            font-family: 'Noto Sans JP', 'Helvetica Neue', 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #121212 0%, #1A1A1A 50%, #0F0F0F 100%);
            min-height: 100vh;
            color: #FFFFFF;
            line-height: 1.8;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: linear-gradient(145deg, #1E1E1E 0%, #2A2A2A 100%);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }
        h1 { font-size: 2.5em; margin-bottom: 30px; color: #FFFFFF; }
        h2 { font-size: 1.8em; margin-top: 40px; margin-bottom: 20px; color: #FFFFFF; border-bottom: 2px solid rgba(255, 255, 255, 0.2); padding-bottom: 10px; }
        h3 { font-size: 1.4em; margin-top: 30px; margin-bottom: 15px; color: #4A9EFF; }
        p, li { color: rgba(255, 255, 255, 0.9); margin-bottom: 15px; font-size: 1.05em; }
        ul, ol { padding-left: 30px; }
        .step-box { background: rgba(74, 158, 255, 0.1); border-left: 4px solid #4A9EFF; padding: 25px; margin: 30px 0; border-radius: 8px; }
        .step-box h3 { margin-top: 0; }
        .info-box { background: rgba(40, 167, 69, 0.1); border-left: 4px solid #28A745; padding: 20px; margin: 25px 0; border-radius: 8px; }
        .warning-box { background: rgba(220, 53, 69, 0.1); border-left: 4px solid #DC3545; padding: 20px; margin: 25px 0; border-radius: 8px; }
        .tip-box { background: rgba(255, 193, 7, 0.1); border-left: 4px solid #FFC107; padding: 20px; margin: 25px 0; border-radius: 8px; }
        code { background: rgba(255, 255, 255, 0.1); padding: 2px 8px; border-radius: 4px; font-family: 'Courier New', monospace; color: #4A9EFF; }
        .nav-links { display: flex; gap: 20px; margin-top: 40px; padding-top: 30px; border-top: 1px solid rgba(255, 255, 255, 0.2); flex-wrap: wrap; }
        .nav-link { display: inline-block; padding: 15px 30px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 10px; color: #FFFFFF; text-decoration: none; transition: all 0.3s; }
        .nav-link:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-2px); }
        a { color: #4A9EFF; text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    {% include 'includes/header.html' %}
    {% include 'includes/breadcrumb.html' %}
    <div class="container">
        <h1>📄 PDFユーティリティガイド</h1>
        <p><strong>できること:</strong> PDFの結合・分割・ページ抽出、PDF→画像（PNG/JPEG）変換、画像→PDF変換。すべてブラウザ内で完結し、サーバーへPDF・画像は送信されません。</p>
        <p><strong>想定ユーザー:</strong> 事務・デザイナー・営業・経理など、複数PDFの統合、ページ抽出、画像化が必要な方。</p>

        <h2>このツールで解決できる課題</h2>
        <ul>
            <li>複数のPDFファイルを1つにまとめたい</li>
            <li>PDFから特定のページだけを抽出したい</li>
            <li>大きなPDFファイルを複数の小さなファイルに分割したい</li>
            <li>PDFを画像ファイルに変換したい</li>
            <li>PDFファイルのサイズを圧縮したい</li>
            <li>複数の画像を1つのPDFにまとめたい</li>
        </ul>

        <h2>主要機能</h2>
        <ul>
            <li><strong>PDF結合</strong>: 複数のPDFファイルを1つに結合</li>
            <li><strong>PDF分割</strong>: PDFをページ範囲で分割</li>
            <li><strong>ページ抽出</strong>: 指定したページのみを抽出</li>
            <li><strong>PDF→画像変換</strong>: PDFの全ページを画像（PNG/JPEG）に変換</li>
            <li><strong>画像→PDF変換</strong>: 複数の画像を1つのPDFに結合</li>
            <li><strong>PDF圧縮</strong>: PDFファイルサイズの削減</li>
        </ul>

        <h2>使い方の流れ（機能別）</h2>

        <div class="step-box">
            <h3>PDF結合</h3>
            <ol>
                <li><a href="/tools/pdf">PDFユーティリティ</a>にアクセス</li>
                <li>「PDF結合」タブを選択</li>
                <li>結合したいPDFファイルを複数選択</li>
                <li>「結合を開始」ボタンをクリック</li>
                <li>結合されたPDFをダウンロード</li>
            </ol>
        </div>

        <div class="step-box">
            <h3>PDF分割</h3>
            <ol>
                <li>「PDF分割」タブを選択</li>
                <li>分割したいPDFファイルを選択</li>
                <li>分割方法を選択（ページ数指定 or ページ範囲指定）</li>
                <li>「分割を開始」ボタンをクリック</li>
                <li>分割されたPDFをZIPでダウンロード</li>
            </ol>
        </div>

        <div class="step-box">
            <h3>ページ抽出</h3>
            <ol>
                <li>「ページ抽出」タブを選択</li>
                <li>抽出元のPDFファイルを選択</li>
                <li>抽出したいページ番号を指定（例: 1,3,5-10）</li>
                <li>「抽出を開始」ボタンをクリック</li>
                <li>抽出されたPDFをダウンロード</li>
            </ol>
        </div>

        <div class="step-box">
            <h3>PDF→画像変換</h3>
            <ol>
                <li>「PDF→画像」タブを選択</li>
                <li>変換したいPDFファイルを選択</li>
                <li>出力形式（PNG/JPEG）と品質を設定</li>
                <li>「変換を開始」ボタンをクリック</li>
                <li>変換された画像をZIPでダウンロード</li>
            </ol>
        </div>

        <h2>入出力仕様</h2>
        <h3>対応入力形式</h3>
        <ul>
            <li>PDF（.pdf）</li>
            <li>画像（PNG、JPG、JPEG、WebP）※画像→PDF変換時</li>
        </ul>
        <h3>出力形式</h3>
        <ul>
            <li>PDF（.pdf）</li>
            <li>画像（PNG、JPEG）※PDF→画像変換時</li>
            <li>ZIP（複数ファイル出力時）</li>
        </ul>
        <h3>制限事項（実装に基づく）</h3>
        <ul>
            <li><strong>PDF（結合・分割・抽出・圧縮）</strong>: 最大20ファイル、1ファイル50MB、合計300MBまで（<code>templates/tools/pdf.html</code> の validateFiles に準拠）</li>
            <li><strong>PDF→画像</strong>: 最大10ファイル、1ファイル50MB、合計300MBまで（同）</li>
            <li><strong>画像→PDF</strong>: 最大100ファイル、1ファイル20MB、合計200MBまで（同）</li>
            <li>パスワード保護PDFは未対応です</li>
        </ul>

        <div class="warning-box">
            <strong>⚠️ 注意事項</strong>
            <p>パスワード保護されたPDFは処理できません。事前に解除してからご利用ください。</p>
        </div>

        <h2 id="data-handling">データの取り扱い</h2>
        <p>当ツールでは、PDF・画像のアップロード・サーバー保存・外部送信は行いません。</p>
        <ul>
            <li><strong>アップロード</strong>: 行いません。処理はすべてブラウザ内で完結します。根拠: <code>app.py</code> に <code>/tools/pdf</code> 向けのファイル受信ルートは存在せず、<code>templates/tools/pdf.html</code> および PDF.js 等でクライアント側のみで処理しています。</li>
            <li><strong>サーバー保存・ログ</strong>: なし。PDF・画像内容はサーバーに送信されません。</li>
        </ul>
        <p>詳細は<a href="/privacy">プライバシーポリシー</a>をご確認ください。</p>

        <h2 id="faq">よくある質問（FAQ）</h2>
        {% set faq_list = [
            {"q": "PDFユーティリティでサーバーにPDFがアップロードされますか？", "a": "いいえ。すべてブラウザ内で処理され、PDF・画像データはサーバーに送信されません。app.py に /tools/pdf 向けのアップロードルートはありません。"},
            {"q": "複数のPDFを1つに結合できますか？", "a": "はい。PDF結合タブで複数ファイルを選択し、「結合を開始」で1つのPDFにまとめられます。最大20ファイルまでです。"},
            {"q": "PDFを画像に変換できますか？", "a": "はい。PDF→画像タブでPDFを選択し、PNGまたはJPEG形式で全ページを画像化できます。最大10ファイルまで。ZIPで一括ダウンロードできます。"},
            {"q": "ページ抽出で指定したページが取得できません。", "a": "ページ番号は1始まりです。範囲指定は「1-10」のようにハイフンで指定できます。0や負の数は無効です。"},
            {"q": "パスワード付きPDFは使えますか？", "a": "いいえ。パスワード保護PDFは未対応です。事前にパスワードを解除してからアップロードしてください。"},
            {"q": "PDF→画像変換が遅いです。", "a": "ページ数が多いと処理時間がかかります。必要なページだけページ抽出で別PDFにしてから画像変換すると効率的です。"},
            {"q": "画像をPDFにまとめられますか？", "a": "はい。画像→PDFタブでPNG/JPG/WebPを選択し、1つのPDFに結合できます。最大100ファイル、1ファイル20MBまでです。"},
            {"q": "結合が失敗します。", "a": "ファイル破損やパスワード保護の可能性があります。別のビューアで開けるか確認し、保護解除後に再試行してください。"}
        ] %}
        <div class="faq-list">
            {% for item in faq_list %}
            <div class="faq-item" style="margin-bottom: 24px;">
                <h3 style="font-size: 1.1em; margin-bottom: 8px;">Q. {{ item.q }}</h3>
                <p style="margin: 0; padding-left: 1em;">A. {{ item.a }}</p>
            </div>
            {% endfor %}
        </div>

        <h2>トラブルシューティング</h2>
        <ul>
            <li><strong>「ファイルが読み込めません」</strong>: パスワード保護や破損の可能性があります。保護を解除するか、別ソフトで開いて再保存してから試してください。</li>
            <li><strong>ページ番号を指定しても抽出されない</strong>: 1始まりで指定してください。例: 1,3,5-10。スペースや全角数字は避けてください。</li>
            <li><strong>結合後にファイルが大きすぎる</strong>: 元PDFの画像解像度が高いとサイズが増えます。PDF→画像で解像度を下げてから再度PDF化する方法があります。</li>
            <li><strong>画像→PDFで順序が乱れる</strong>: 選択した順序で結合されます。ファイル名の並びで制御できる場合があります。</li>
            <li><strong>処理が途中で止まる</strong>: ブラウザのメモリ不足の可能性があります。ファイル数・ページ数を減らして再試行してください。</li>
        </ul>

        <div class="tip-box">
            <strong>💡 効率的な使い方</strong>
            <ul style="margin-top: 10px;">
                <li>ページ抽出では範囲指定（1-10）を使うと効率的です。</li>
                <li>大量のPDFは一度に20ファイル以内に分けて処理することをおすすめします。</li>
            </ul>
        </div>

        {% set tool_path = '/tools/pdf' %}
        {% set tool_name = 'PDFユーティリティ' %}
        {% include 'guide/_partials/guide_related_links.html' %}

        <div class="nav-links">
            <a href="/tools/pdf" class="nav-link">← PDFユーティリティに戻る</a>
            <a href="/tools" class="nav-link">← ツール一覧へ</a>
            <a href="/guide/image-cleanup" class="nav-link">次のガイド: 画像ユーティリティ →</a>
        </div>
    </div>
    {% include 'guide/_partials/guide_faq_jsonld.html' %}
    {% include 'includes/footer.html' %}
</body>
</html>
